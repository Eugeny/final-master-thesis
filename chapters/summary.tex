\section{Summary}
\subsection{Results}
\begin{itemize}
    \item In the scope of this master thesis three deep learning models were developed that are able to predict fluorescence signal from DIC image data for the following targets: nuclei, endoplasmic reticulum and full cell surface. Developed models can successfully replace a manual fluorescence staining procedure. 
    
    \item Several adjustments before running any longer training experiment to model's training pipeline were made. First, the model's architecture from \cite{Lachance_2020} that was used in the experiments was improved in terms of faster learning with the use of batch normalization layers. Second, additional image augmentations like rotations and scaling were added and their logic was improved through the use of the high-resolution original image from the standard one. Third, the importance of a correct weight initialization was presented. And lastly, the model was tuned by choosing the correct regularization and optimization algorithms (batch normalization and adadelta optimization in this case). 
    
    \item For each of the four targets corresponding image preprocessing pipelines were developed. This step was very important to improve training data quality and address models' limitations before training, such as background-foreground class imbalance for instance. In the the Golgi apparatus preprocessing pipeline advanced methods like background removal using a rolling ball algorithm and image enhancement were introduced.
    
    \item In each training procedure, the model has successfully converged for all fluorescence targets except for the Golgi apparatus. Training experiments for the Golgi target showed that there is a lack of training data with high enough signal-to-noise ratio. Therefore further research can be carried out after a better antibody for staining will be purchased. However, several attems to improve model's predictions for the Golgi apparatus target were made via the use asymmentrical losses and advanced image preprocessing techniques. This technique can also potentially remove the unwanted fluorescence shining in the input nuclei fluorescence imaging. However, as the nuclei predictions were already of a good quiality an improved preprocessing technique was not applied to this target. 
    
    \item Models' limitations in terms of intensity predictions were resolved. Based on visualizations and biological metrics estimations it was derived that the models have a similar downside in overpredicting total and mean intensities. Nevertheless, a strong correlation between the values suggests that there is an absolute value shift in predictions that can be fixed with relative ease. This issue was solved with the use of a bigger model and more data respectively. An immediate improvement was observed when it comes to the correlation coefficients between the prediction and ground truth in the total and mean intensities.
    
    \item For a better evaluation of the models more practical biological metrics were proposed. These are organelle quantity, total intensity, mean intensity and area of the organelle of interest. Every model was evaluated based on these metrics. It was shown that not only a significant correlation with ground truth values in terms of Pearson and Spearman rank correlation coefficients is present, but that the forms of distributions visualized with violin plots are very similar.
    
    \item For each organelle in question corresponding segmentation pipelines were developed, since the evaluation of the models on biological metrics require the segmentation of each predicted organelle. Postprocessing procedures for segmentation were successfully built with the OpenCV and \textit{skimage} libraries. 
    
    \item Generalizability study of the models across cell phenotypes and across not fixed cells was carried out. Regardless on which cell size was the model trained, it was able to generalize across different cell scales if the difference is under $30\%$. However, biological metrics show that intensities can be better reproduced when training on bigger cells. Lastly, an inductive bias of a model for full cell surface was determined: the model is able to select all the cells in the foreground regardless their state (both live and dead).

    \item Apart from generalizability models were tested on the stability of their predictions. For that goal artificially corrupted via image processing (like brightness, contrast changes and defocus blur imitations) data and data corrupted from faulty microscopy settings were introduced. It was shown that the models are very stable against changes in contrast and brightness, which can be caused by an over- or underexposure. Even though the models were very prone to errors with defocus blur corruption, using artificial corruptions as training augmentations improves models performance on corrupted images. Prediction on the image with corruptions created in the laboratory have shown that the models are stable against errors in cell fixation process, however they are quite sensitive towards errors in the focus of the microscope.
    
    \item UNet embeddings were studied for the possible source of additional data insights like phenotype differences or corruptions and unsupervised clustering algorithms were applied. The study has shown that image embeddings are not clustered based on cell phenotype, however corrupted images indeed form a separate cluster in the embeddings space. Nevertheless, this cluster is not well-separable from the rest of the data and further research is required. In an attempt to find a lower dimensional embedding for image representation an autoencoder embedding that was trained. The training has been carried out using the same data and the embeddings were checked for the same clustering targets. The results have shown strong clustering based on the brightness of the crops, which is not significant for this research.
    
    \item Finally, In order to detect corruprions and determine whether models' predictions should or should not be reliable, two drift detection algorithms were developed. The first one is based on the maximum mean discrepancy method, and the second one is an online version of the first one. They were tested on both corruption types and have shown strong ability for detecting drift in data with high ROC-AUC scores.
\end{itemize}
%Intensity fluorescence predictions as well as binary segmentation (for the full cell surface target) were visualized. 

\subsection{Limitations}
The main limitation of this research is the need to fix the cells before taking DIC images of them. Cell fixation is a preceding step before cell staining --- therefore all cells in datasets of DIC images were fixed. Since living and fixed cells look very different and models trained on fixed cells do not generalize to non-fixed ones well, predictions can be carried out on DIC images of fixed cells only. Luckily, fixing procedure is not a cumbersome lab procedure and is far easier than staining the cells, which is avoided with the help of \textit{in-silico} fluorescence labeling. It is recommended to look into possibilities of transfer learning from fixed to living cells. 
Also, models developed here cannot generalize well on other cell types and are able to produce accurate predictions for the cells used in this laboratory only. However, in future the developed product would aim to address the specific needs of each laboratory separately. Therefore the models will be trained with the goal to address the issues of one specific cell line. 


\subsection{Future research}
This research sets the ground for a variety of further research ideas:
\begin{itemize}
    \item As the Golgi apparatus model did not produce good enough predictions due to several reasons (such as low signal-to-noise ratio in input data, as well as an extremely strong class imbalance between the foreground and background in images), it is strongly recommended to continue research in this direction. For example, by choosing another target protein in the staining procedure, applying stronger noise reduction approaches as introduced by \cite{noise2void}, and incorporating image gradients in the loss function.
    \item UNet embeddings do indeed show a potential for detecting corruptions in crops, however it is not strong enough. It is highly recommended to incorporate embeddings of all crops from the same image into one point in the embedding space. For example, by averaging the embeddings. This might show a more significant clustering of corrupted data.
    \item Since autoencoder embeddings have shown clear clustering based on the crop brightness, it would be beneficial to normalize the brightness across all crops first. This would allow an autoencoder to pay attention to other less distinctive features in the image.
    \item Due to time constraints it was not possible to train very big models, however the improvement of prediction quality that occurs after a model enlargement is very significant. Therefore it is recommended to train models with a bigger model size and more data.
    \item The lack of data concerning corruptions from the microscopy settings did not allow to test online drift detection algorithm. As this version very promising for practical use it is recommended to use more data for its testing.
    \item Since the model for full cell surface predictions is not able to distinguish between dead and live cells, it is recommended to add more images that include dead cells into the dataset or to train an alternative model that is able to distinguish them (\cite{Ounkomol_2018}).
\end{itemize}
 